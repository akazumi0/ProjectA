<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Falling Stars">
    <meta name="description" content="GÃ©rez le flux stellaire, construisez votre empire cosmique et sauvez la Terre">
    <meta name="theme-color" content="#00d4ff">
    <link rel="manifest" href="./manifest.json">
    <link rel="apple-touch-icon" href="./src/assets/icon.svg">
    <link rel="icon" type="image/svg+xml" href="./src/assets/icon.svg">
    <title>Falling Stars â€“ Foundations of Light</title>

    <!-- Modular CSS Architecture -->
    <link rel="stylesheet" href="./src/css/base.css">
    <link rel="stylesheet" href="./src/css/layout.css">
    <link rel="stylesheet" href="./src/css/ui.css">
    <link rel="stylesheet" href="./src/css/modals.css">
    <link rel="stylesheet" href="./src/css/welcome.css">
</head>
<body>
    <!-- Game Canvas -->
    <canvas id="gameCanvas"></canvas>

    <!-- Notification System -->
    <div id="notification"></div>

    <!-- ASTRA Dialogue Bubble -->
    <div id="astraDialogue">
        <div class="astra-text" id="astraText"></div>
        <div class="astra-name">â€” ASTRA</div>
    </div>

    <!-- Combo Display -->
    <div id="comboDisplay">
        <div class="combo-text">COMBO x<span id="comboCount">1</span></div>
        <div class="combo-multiplier" id="comboMultiplier">+100%</div>
    </div>

    <!-- Flash Mission Banner -->
    <div id="flashMission">
        <div class="flash-title"><span id="flashMissionIcon"></span> <span id="flashMissionName"></span></div>
        <div class="flash-desc" id="flashMissionDesc"></div>
        <div class="flash-progress">
            <div class="flash-progress-bar" id="flashProgressBar" style="width: 0%">
                <span id="flashProgressText">0/0</span>
            </div>
        </div>
        <div class="flash-timer" id="flashTimer">â±ï¸ 00:00</div>
    </div>

    <!-- Right Quest Panel -->
    <div id="rightQuestPanel"></div>

    <!-- Story Event Modal -->
    <div id="storyEventModal">
        <div class="story-event-content">
            <div class="story-event-icon" id="storyEventIcon"></div>
            <div class="story-event-title" id="storyEventTitle"></div>
            <div class="story-event-desc" id="storyEventDesc"></div>
            <div id="storyEventChoices"></div>
        </div>
    </div>

    <!-- Welcome Screen -->
    <div id="welcome">
        <div id="welcomeMain">
            <h1>â­ FALLING STARS â­</h1>
            <div class="subtitle">The Last Honest Idle Game</div>

            <div class="manifesto-box">
                <p class="manifesto-text">Un jeu mobile peut-il Ãªtre Ã  la fois fun ET Ã©thique ?</p>
                <div class="manifesto-list">
                    <div class="manifesto-item">âœ“ <strong>ZÃ‰RO</strong> publicitÃ©</div>
                    <div class="manifesto-item">âœ“ <strong>Fair Play</strong> garanti (leaderboards sÃ©parÃ©s)</div>
                    <div class="manifesto-item">âœ“ <strong>Transparent</strong> (formules visibles)</div>
                    <div class="manifesto-item">âœ“ <strong>Ã‰ducatif</strong> (vraie science spatiale)</div>
                </div>
            </div>

            <div class="tier-choice">
                <p style="font-size: 12px; color: #aaa; margin: 15px 0 10px;">Choisissez votre expÃ©rience :</p>
                <button class="tier-btn free-tier active" onclick="selectTier('FREE')">
                    <div class="tier-badge">ğŸ†“</div>
                    <div class="tier-name">Free Player</div>
                    <div class="tier-desc">Jeu complet gratuit</div>
                </button>
                <button class="tier-btn supporter-tier" onclick="selectTier('SUPPORTER')" disabled>
                    <div class="tier-badge">â­</div>
                    <div class="tier-name">Supporter</div>
                    <div class="tier-desc">$2.99 â€¢ CosmÃ©tiques + QoL</div>
                    <div class="tier-coming">BientÃ´t disponible</div>
                </button>
                <button class="tier-btn fast-tier" onclick="selectTier('FAST_PASS')" disabled>
                    <div class="tier-badge">â±ï¸</div>
                    <div class="tier-name">Time Traveler</div>
                    <div class="tier-desc">$4.99 â€¢ Time-savers</div>
                    <div class="tier-coming">BientÃ´t disponible</div>
                </button>
            </div>

            <div class="username-section">
                <p style="font-size: 11px; color: #aaa; margin-bottom: 8px;">Votre nom de Commandant :</p>
                <input type="text" id="usernameInput" placeholder="Commandant..." maxlength="15">
            </div>

            <button class="start-btn" onclick="startGame()">âš¡ COMMENCER L'AVENTURE</button>

            <div class="manifesto-link" onclick="showManifesto()">ğŸ“– Lire notre manifeste complet</div>
        </div>

        <!-- Manifesto Full Screen -->
        <div id="welcomeManifesto" style="display: none;">
            <h2>Notre Manifeste</h2>
            <div class="manifesto-full">
                <h3>Pourquoi "The Last Honest Idle Game" ?</h3>
                <p>Le marchÃ© mobile est saturÃ© de jeux qui exploitent les joueurs avec des publicitÃ©s invasives, des achats pay-to-win, et des mÃ©caniques manipulatrices.</p>

                <h3>Nos Engagements</h3>
                <ul>
                    <li><strong>Transparence Totale</strong> : Toutes les formules du jeu sont accessibles. Pas de boÃ®te noire.</li>
                    <li><strong>Fair Play</strong> : Les joueurs Free, Supporter et Fast Pass ont des leaderboards sÃ©parÃ©s.</li>
                    <li><strong>Pas de Dark Patterns</strong> : Pas de FOMO artificiel, pas de timers agressifs, pas de lootboxes payantes.</li>
                    <li><strong>Ã‰ducatif</strong> : Chaque technologie est basÃ©e sur de vraie science. Apprenez en jouant.</li>
                    <li><strong>Community-Driven</strong> : Vos retours comptent. Le jeu Ã©volue avec vous.</li>
                </ul>

                <h3>MonÃ©tisation Ã‰thique</h3>
                <p>Si vous aimez le jeu, vous pouvez devenir <strong>Supporter</strong> (cosmÃ©tiques) ou <strong>Time Traveler</strong> (time-savers). Mais le jeu complet est 100% gratuit.</p>

                <p style="margin-top: 20px; font-style: italic; color: #888;">Fait avec â¤ï¸ par 2 dÃ©veloppeurs indÃ©pendants qui croient qu'un autre gaming mobile est possible.</p>
            </div>
            <button class="start-btn" onclick="hideManifesto()">â† RETOUR</button>
        </div>
    </div>

    <!-- Profile Modal -->
    <div id="profileModal">
        <div class="modal-content">
            <div class="modal-header">PROFIL DU COMMANDANT</div>
            <div class="modal-body">
                <div class="stat-row">
                    <span class="stat-label">Nom</span>
                    <span class="stat-value" id="modalUsername">-</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Score Total</span>
                    <span class="stat-value" id="modalScore">0</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Lumen Total</span>
                    <span class="stat-value" id="modalLumen">0</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">PlanÃ¨tes</span>
                    <span class="stat-value" id="modalPlanets">1/3</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Technologies</span>
                    <span class="stat-value" id="modalTechs">0</span>
                </div>
            </div>
            <button class="close-btn" onclick="closeProfile()">FERMER</button>
        </div>
    </div>

    <!-- Header -->
    <div id="header" style="display: none;">
        <div class="resources">
            <div class="resource">
                <div>â­ Lumen</div>
                <div class="resource-value" id="lumenVal">0</div>
                <div class="resource-rate" id="lumenRate">+0/s</div>
            </div>
            <div class="resource">
                <div>âš¡ Ã‰nergie</div>
                <div class="resource-value" id="energyVal">0</div>
                <div class="resource-rate" id="energyRate">+0/s</div>
            </div>
            <div class="resource">
                <div>ğŸ’¥ AntimatiÃ¨re</div>
                <div class="resource-value" id="antimatterVal">0</div>
                <div class="resource-rate" id="antimatterRate">Rare</div>
            </div>
        </div>
        <div id="planetSelector">
            <span class="profile-icon" onclick="openProfile()" title="Profil">ğŸ‘¤</span>
            ğŸŒ PlanÃ¨te: <select id="planetSelect" onchange="switchPlanet(this.value)"></select>
        </div>
    </div>

    <!-- Left Icon Bar -->
    <div id="leftIconBar" style="display: none;">
        <div class="icon-button" onclick="openModal('daily')" id="dailyIcon">ğŸ</div>
        <div class="icon-button" onclick="openModal('lootbox')" id="lootboxIcon">ğŸ“¦</div>
        <div class="icon-button" onclick="openModal('quests')" id="questsIcon">ğŸ“œ</div>
        <div class="icon-button" onclick="openModal('achievements')" id="achievementsIcon">ğŸ†</div>
        <div class="icon-button" onclick="openModal('artifacts')" id="artifactsIcon">ğŸ’</div>
        <div class="icon-button" onclick="openModal('events')" id="eventsIcon">ğŸŒŸ</div>
        <div class="icon-button" onclick="openModal('stats')" id="statsIcon">ğŸ“Š</div>
        <div class="icon-button" onclick="openModal('prestige')" id="prestigeIcon">ğŸŒ </div>
        <div class="icon-button" onclick="openModal('shop')" id="shopIcon">ğŸª</div>
    </div>

    <!-- Modals -->
    <!-- Daily Rewards Modal -->
    <div id="dailyModal" class="modal-overlay">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('daily')">âœ•</button>
            <div class="modal-header">ğŸ RÃ‰COMPENSES JOURNALIÃˆRES</div>
            <div class="modal-body">
                <div style="text-align: center; margin: 15px 0;">
                    <div id="dailyDays"></div>
                </div>
                <button class="sidebar-btn green" id="claimDailyBtn" onclick="claimDaily()">COLLECTER</button>
            </div>
        </div>
    </div>

    <!-- Lootbox Modal -->
    <div id="lootboxModal" class="modal-overlay">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('lootbox')">âœ•</button>
            <div class="modal-header">ğŸ“¦ COFFRE GRATUIT</div>
            <div class="modal-body">
                <div id="freeLootboxTimer" class="timer-text">--:--:--</div>
                <div class="reward-text">Disponible toutes les 2 heures</div>
                <button class="sidebar-btn" id="openFreeLootboxBtn" onclick="openFreeLootbox()" disabled>OUVRIR</button>
            </div>
        </div>
    </div>

    <!-- Achievements Modal -->
    <div id="achievementsModal" class="modal-overlay">
        <div class="modal-content" style="max-width: 500px;">
            <button class="modal-close" onclick="closeModal('achievements')">âœ•</button>
            <div class="modal-header">ğŸ† SUCCÃˆS</div>
            <div class="modal-body" id="achievementsBody" style="max-height: 60vh; overflow-y: auto;">
                <!-- Populated by JS -->
            </div>
        </div>
    </div>

    <!-- Quests Modal -->
    <div id="questsModal" class="modal-overlay">
        <div class="modal-content" style="max-width: 500px;">
            <button class="modal-close" onclick="closeModal('quests')">âœ•</button>
            <div class="modal-header">ğŸ“œ QUÃŠTES QUOTIDIENNES</div>
            <div class="modal-body" id="questsBody" style="max-height: 60vh; overflow-y: auto;">
                <!-- Populated by JS -->
            </div>
        </div>
    </div>

    <!-- Events Modal -->
    <div id="eventsModal" class="modal-overlay">
        <div class="modal-content" style="max-width: 500px;">
            <button class="modal-close" onclick="closeModal('events')">âœ•</button>
            <div class="modal-header">ğŸŒŸ Ã‰VÃ‰NEMENTS & BOOSTS</div>
            <div class="modal-body" id="eventsBody" style="max-height: 60vh; overflow-y: auto;">
                <!-- Populated by JS -->
            </div>
        </div>
    </div>

    <!-- Stats Modal -->
    <div id="statsModal" class="modal-overlay">
        <div class="modal-content" style="max-width: 500px;">
            <button class="modal-close" onclick="closeModal('stats')">âœ•</button>
            <div class="modal-header">ğŸ“Š STATISTIQUES</div>
            <div class="modal-body" id="statsBody" style="max-height: 60vh; overflow-y: auto;">
                <!-- Populated by JS -->
            </div>
        </div>
    </div>

    <!-- Artifacts Modal -->
    <div id="artifactsModal" class="modal-overlay">
        <div class="modal-content" style="max-width: 500px;">
            <button class="modal-close" onclick="closeModal('artifacts')">âœ•</button>
            <div class="modal-header">ğŸ’ ARTEFACTS</div>
            <div class="modal-body" id="artifactsBody" style="max-height: 60vh; overflow-y: auto;">
                <!-- Populated by JS -->
            </div>
        </div>
    </div>

    <!-- Prestige Modal -->
    <div id="prestigeModal" class="modal-overlay">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('prestige')">âœ•</button>
            <div class="modal-header">ğŸŒ  PRESTIGE</div>
            <div class="modal-body">
                <div class="info-row">
                    <div class="info-label">Niveau actuel</div>
                    <div class="info-value" id="prestigeLevel">0</div>
                </div>
                <div class="info-row">
                    <div class="info-label">Bonus de production</div>
                    <div class="info-value">+<span id="prestigeBonus">0</span>%</div>
                </div>
                <div class="info-row">
                    <div class="info-label">Progression</div>
                    <div class="info-value" id="prestigeProgress">--</div>
                </div>
                <div style="margin: 15px 0; padding: 10px; background: rgba(255,50,50,0.1); border: 1px solid rgba(255,50,50,0.3); border-radius: 5px; font-size: 11px; text-align: center;">
                    âš ï¸ Le prestige rÃ©initialise tout sauf les technologies
                </div>
                <button class="sidebar-btn gold" id="prestigeBtn" onclick="doPrestige()" disabled>PRESTIGE</button>
            </div>
        </div>
    </div>

    <!-- Shop Modal -->
    <div id="shopModal" class="modal-overlay">
        <div class="modal-content" style="max-width: 500px;">
            <button class="modal-close" onclick="closeModal('shop')">âœ•</button>
            <div class="modal-header">ğŸª BOUTIQUE</div>
            <div class="modal-body" id="shopBody" style="max-height: 60vh; overflow-y: auto;">
                <!-- Populated by JS -->
            </div>
        </div>
    </div>

    <!-- Bottom UI -->
    <div id="bottomUI" style="display: none;">
        <div id="tabs">
            <div class="tab active" onclick="switchTab(0)">DÃ‰FENSE</div>
            <div class="tab" onclick="switchTab(1)">BÃ‚TIMENTS</div>
            <div class="tab" onclick="switchTab(2)">TECHNOLOGIES</div>
        </div>

        <div id="defense" class="tab-content active"></div>
        <div id="buildings" class="tab-content"></div>
        <div id="technologies" class="tab-content"></div>
    </div>

    <!-- ES6 Module Entry Point -->
    <script type="module" src="./src/js/main.js"></script>
</body>
</html>
